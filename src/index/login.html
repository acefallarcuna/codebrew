<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <title>HackFest</title>

  <!-- CSS AND BOOTSTRAP -->
  <link rel="stylesheet" href="/src/index/logInStyles.css">
  <link rel="stylesheet" href="/src/index/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
  <link rel="Icon" href="/Images/ProTech Logo NoText.png" type="image/png">

  <!-- BOOTSTRAP WITH JAVASCRIPT -->
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous"></script>

  <!-- FONT AWESOME -->
  <script defer src="https://use.fontawesome.com/releases/v6.1.2/js/all.js"></script>
</head>

<body data-bs-target="#NAVBAR" style="font-family: 'Inter'; background-color: #f8f7f2;">
    <nav class="autohide navbar navbar-expand-lg fixed-top" id="NAVBAR">
        <div class="container-fluid">
          <a class="navbar-brand" href="/index.html"><img src="/Images/LogoWhite2.png" alt="Logo" class="logo"></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#main_nav">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="main_nav">
            <ul class="navbar-nav">
            <li class="nav-item">
            <a class="nav-link" href="productsPage.html"> Products </a>
            </li>
            <li class="nav-item">
            <a class="nav-link" href="about.html"> About Us </a>
            </li>
            <li class="nav-item">
            <a class="nav-link" href="infopage.html"> What is Insurance? </a>
            </li>
            
            </ul>
            <ul class="navbar-nav ms-auto">
              <li class="nav-itembutton">
              <a href="/src/index/Register.html"><button type="button" class="btnNav"><b>Join Us!</b></button></a>
              </li>
            </ul>
          </div> 
        </nav>
<br><br><br>
  <div class="d-flex align-items-center justify-content-center">
    <div class="row">
      <div class="col-12 col-sm-11 col-xl-10 offset-xl-1">
        <div class="my-5">
          <div class="cardbody p-lg-4 rounded-5">
            <div class="text-center">
              <img src="/Images/LogoWhite1.png" class="Logo" alt="image">
            </div>

            <div class="row">
              <!-- <div class="col-10 offset-sm-1 mb-3 input-effect">
                <label class="txt" style="padding-bottom: 20px;">Email</label>
                <input class="effect-16 txt" type="text" id="email" placeholder="Enter Email">
                <span class="focus-border"></span>
            </div> -->

            <div class="col-10 offset-sm-1 mt-1 mb-5">
              <input type="text" class="form-control" placeholder="Email" aria-label="Email" aria-describedby="basic-addon1"
                size="20" id="email">
            </div>

            <!-- <div class="col-10 offset-sm-1 mb-3 input-effect">
              <label class="txt" style="padding: 20px 0px;">Password</label><br>
              <input class="effect-16 txt" type="password" name="password" id="password" placeholder="Enter Password">
              <span class="focus-border"></span>
            </div> -->

            <div class="col-10 offset-sm-1 mt-1 mb-5">
              <input type="text" class="form-control" placeholder="Password" aria-label="Password" aria-describedby="basic-addon1"
                size="20" name="password" id="password">
            </div>

            <div id="emailHelp" class="form-text text-center my-3 txt">Don't have an Account? <a href="Register.html" class=" fw-bold txt"> Create an Account</a>
              <div class="text-center">
                <form id="login-form">
                  <button type="submit" class="btn btn-color px-1 mt-5">Login</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <section id="Footer">
    <div class="row g-0 text-center">
      <div class="col">
        <img src="/Images/LogoWhite2.png" alt="Logo" class="logo">
      </div>
      <div class="col">
          <h6><b>Frequently Asked Questions</b></h6>
          <p>
            Lorem Ipsum
          </p>
          <p>
            Lorem Ipsum
          </p>
      </div>
      <div class="col">
          <h6><b>About Us</b></h6>
          <p>
            Lorem Ipsum
          </p>
          <p>
            Lorem Ipsum
          </p>
      </div>
      <div class="col">
          <h6><b>Products</b></h6>
          <p>
            Lorem Ipsum
          </p>
          <p>
            Lorem Ipsum
          </p>
      </div>
      <div class="col">
        <h6><b>Customer Service</b></h6>
        <p>
          Lorem Ipsum
        </p>
        <p>
          Lorem Ipsum
        </p>
    </div>
      <hr style="border-top: 3px solid #f8f7f2">
      <p style="text-align: center; color: #f8f7f2;"><b>Copyright Â© 2023 ProTech Inc. All rights reserved.</b></p>
    </div>
  </section>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="/src/index/index.js"></script>
  <script>
    const SUPABASE_URL = 'https://rjleemtypmpnpcyiuana.supabase.co'
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJqbGVlbXR5cG1wbnBjeWl1YW5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODE3MzcxNTQsImV4cCI6MTk5NzMxMzE1NH0.r4sZNa25TeerGsV2-duD1GVbZchLDoqxl3D0tNT3bjE'

    const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

    const Home = () => {
      console.log(supabase);
      console.log("Working");
    };
    Home()
    
    async function insertData(email, firstName, lastName, birthday, contactNumber, password) {
      // Check if customer already exists in database
      const { data: existingData, error } = await _supabase
        .from('Customer')
        .select('*')
        .eq('email', email)
    
      if (error) {
        console.log('Error inserting data:', error.message)
        return
      }
    
      if (existingData.length > 0) {
        console.log('Data already exists:', existingData)
        return
      }
    
      // Define data object to insert
      const data = {
        email: email,
        firstName: firstName,
        lastName: lastName,
        birthday: birthday,
        contactNumber: contactNumber,
        password: password
      }
    
      // Insert data into table
      const { data: insertedData, error: insertError } = await _supabase
        .from('Customer')
        .insert(data)
    
      // Check for errors
      if (insertError) {
        console.log('Error inserting data:', insertError.message)
      } else {
        console.log('Data inserted successfully:', insertedData)
      }
    }
    
    $('#my-form').submit(async function(event) {
      event.preventDefault()
    
      // Get form field values
      const email = $('#email').val()
      const firstName = $('#first-name').val()
      const lastName = $('#last-name').val()
      const birthday = $('#birthday').val()
      const contactNumber = $('#contact-number').val()
      const password = $('#password').val()
    
      // Insert data into Supabase table if it doesn't already exist
      await insertData(email, firstName, lastName, birthday, contactNumber, password)
      location.reload();
    })

    // Get user data from Supabase table using email address
    async function getUserData(email) {
      const { data, error } = await _supabase
        .from('Customer')
        .select('firstName')
        .eq('email', email)

      if (error) {
        console.log('Error getting user data:', error.message)
        return null
      }

      if (data.length > 0) {
        return data[0].firstName
      }

      return null
    }

// Update UI to display logged-in user's name
async function updateLoggedInUserName(email) {
  const firstName = await getUserData(email)

  if (firstName) {
    $('#user-name').text(firstName)
  } else {
    $('#user-name').text('User')
  }
}

  // Check if login credentials match records in Supabase table
  async function login(email, password) {
    const { data, error } = await _supabase
      .from('Customer')
      .select('*')
      .eq('email', email)
      .eq('password', password)

    if (error) {
      console.log('Error logging in:', error.message)
      return
    }

    if (data.length > 0) {
      console.log('Login successful:', data[0])
      window.location.href = '/src/Login/index.html' // Redirect to index.html on successful login
    } else {
      console.log('Login failed: email or password is incorrect')
      // Do something here if login fails, e.g. display error message to user
    }
  }

  // Handle form submission for login
  $('#login-form').submit(async function(event) {
    event.preventDefault()

    // Get form field values
    const email = $('#email').val()
    const password = $('#password').val()

    // Check if login credentials match records in Supabase table
    await login(email, password)
  })

</script>
<script src="//code.tidio.co/noy2rtmsc4sh7aboce2lu5ukxdn8couv.js" async></script>
</body>

</html>